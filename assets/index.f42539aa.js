(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))y(u);new MutationObserver(u=>{for(const h of u)if(h.type==="childList")for(const r of h.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&y(r)}).observe(document,{childList:!0,subtree:!0});function s(u){const h={};return u.integrity&&(h.integrity=u.integrity),u.referrerpolicy&&(h.referrerPolicy=u.referrerpolicy),u.crossorigin==="use-credentials"?h.credentials="include":u.crossorigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function y(u){if(u.ep)return;u.ep=!0;const h=s(u);fetch(u.href,h)}})();var O=function(e,t,s,y,u){if(!u){var h=[];u=function(M,V){h.push({x:M,y:V})}}var r=s-e,a=y-t,o=Math.abs(r),x=Math.abs(a),p=0,n=r>0?1:-1,i=a>0?1:-1;if(o>x)for(var f=e,c=t;n<0?f>=s:f<=s;f+=n)u(f,c),p+=x,p<<1>=o&&(c+=i,p-=o);else for(var f=e,c=t;i<0?c>=y:c<=y;c+=i)u(f,c),p+=o,p<<1>=x&&(f+=n,p-=x);return h};let w=Math.floor(window.innerWidth/3.05),b=Math.floor(window.innerHeight/3.85);const T=[],A=60,D=1/A;let Y=!1,d=!1,q=!0,E=!1,B=300,g=2,v=500,F=[],m=100,P=m*.75,L=300,S=20,C=25,W=7.5,H=1,I=5,N=30,l=G();function j(){for(let e=0;e<v;e++)F.push({x:Math.random()*w,y:Math.random()*b,vx:Math.random()-.5,vy:Math.random()-.5});for(let e=0;e<b;e++)T[e]=new Array(w).fill(0);window.addEventListener("mousemove",e=>{if(e.buttons==1&&l.length<v){let t={x:~~(e.x/3.05),y:~~(e.y/3.85)};l.findIndex(y=>y.x===t.x&&y.y===t.y)===-1&&(l.push(t),q=!1,document.title="Boids "+(v-l.length))}}),window.addEventListener("keydown",e=>{e.preventDefault(),e.code=="KeyP"&&(Y=!Y),E&&e.code=="KeyC"&&(l=[],q=!1,document.title="Boids "+(v-l.length)),e.code=="KeyE"&&(E=!E,d=!1),e.code=="Space"&&(d=!1,F.forEach(t=>{t.vx=Math.random()-.5,t.vy=Math.random()-.5})),e.code=="KeyR"&&(B=300,d=!d)})}function K(e,t){t>=0&&~~t<b&&e>=0&&~~e<w&&(T[~~t][~~e]=1)}function X(e,t,s){let y=e*Math.cos(s)-t*Math.sin(s),u=e*Math.sin(s)+t*Math.cos(s);return[y,u]}function k(e,t,s,y){let u=Math.atan2(y,s)+Math.PI/2,[h,r]=X(0,-g,u);r+=t,h+=e;let[a,o]=X(g,g,u);a+=e,o+=t;let[x,p]=X(-g,g,u);x+=e,p+=t,O(h,r,a,o,K),O(a,o,x,p,K),O(x,p,h,r,K)}function R(){let e="";B--;for(let t=0;t<b;t++){d&&q&&B<0?e+="<span style='color: hsl("+t*2+", 100%, 50%)'>":d&&!q?e+="<span style='color: hsl(100, 100%, 50%)'>":e+="<span>";for(let s=0;s<w;s++)e+=T[t][s]>0?"@":" ",T[t][s]=0;e+="</span><br>"}document.querySelector("#app").innerHTML="<pre><tt>"+e+"</tt></pre>"}function z(e){if(m=d?75:100,P=m*.75,!Y){for(let t=0;t<v;t++){let s=F[t];s.x+=s.vx*e,s.y+=s.vy*e;let y=0,u=0,h=0,r=0,a=0,o=0,x=0;for(let n=0;n<v;n++){let i=F[n],f=i.x-s.x,c=i.y-s.y,M=Math.sqrt(f*f+c*c);M>0&&M<C&&(M<W&&(h+=s.x-i.x,r+=s.y-i.y),y+=i.x,u+=i.y,a+=i.vx,o+=i.vy,x++)}if(x>0&&(y/=x,u/=x,a/=x,o/=x,s.vx+=(y-s.x)*(H*e),s.vy+=(u-s.y)*(H*e),s.vx+=(a-s.vx)*(I*e),s.vy+=(o-s.vy)*(I*e)),s.vx+=h*N*e,s.vy+=r*N*e,d){let n=~~(t/(v/l.length));n<l.length&&(s.vx+=l[n].x-s.x,s.vy+=l[n].y-s.y)}const p=Math.sqrt(s.vx*s.vx+s.vy*s.vy);p>m&&(s.vx=s.vx/p*m,s.vy=s.vy/p*m),p<P&&(s.vx=s.vx/p*P,s.vy=s.vy/p*P),s.x>w-S?s.vx-=L*e:s.x<S&&(s.vx+=L*e),s.y>b-S?s.vy-=L*e:s.y<S&&(s.vy+=L*e),k(s.x,s.y,s.vx,s.vy)}R()}}j();for(;;){let e=performance.now();E?(l.forEach(y=>K(y.x,y.y)),R()):z(D);let t=performance.now()-e,s=D*1e3-t;await new Promise(y=>setTimeout(y,s>0?s:0))}function G(){let e=[];return e.push({x:20,y:20}),e.push({x:20,y:30}),e.push({x:20,y:40}),e.push({x:20,y:50}),e.push({x:20,y:60}),e.push({x:20,y:70}),e.push({x:20,y:80}),e.push({x:20,y:90}),e.push({x:20,y:100}),e.push({x:20,y:110}),e.push({x:20,y:120}),e.push({x:20,y:130}),e.push({x:20,y:140}),e.push({x:20,y:150}),e.push({x:20,y:160}),e.push({x:30,y:20}),e.push({x:40,y:20}),e.push({x:50,y:20}),e.push({x:60,y:20}),e.push({x:70,y:22}),e.push({x:80,y:25}),e.push({x:88,y:30}),e.push({x:95,y:35}),e.push({x:100,y:42}),e.push({x:103,y:50}),e.push({x:105,y:60}),e.push({x:103,y:70}),e.push({x:95,y:78}),e.push({x:85,y:83}),e.push({x:75,y:84}),e.push({x:65,y:85}),e.push({x:55,y:85}),e.push({x:45,y:85}),e.push({x:35,y:85}),e.push({x:25,y:85}),e.push({x:34,y:95}),e.push({x:43,y:105}),e.push({x:52,y:115}),e.push({x:61,y:125}),e.push({x:70,y:135}),e.push({x:79,y:145}),e.push({x:88,y:160}),e.push({x:150,y:20}),e.push({x:150,y:30}),e.push({x:150,y:40}),e.push({x:150,y:50}),e.push({x:150,y:60}),e.push({x:150,y:70}),e.push({x:150,y:80}),e.push({x:150,y:90}),e.push({x:150,y:100}),e.push({x:150,y:110}),e.push({x:150,y:120}),e.push({x:150,y:130}),e.push({x:150,y:140}),e.push({x:150,y:150}),e.push({x:150,y:160}),e.push({x:160,y:20}),e.push({x:170,y:20}),e.push({x:180,y:20}),e.push({x:190,y:20}),e.push({x:200,y:20}),e.push({x:210,y:20}),e.push({x:220,y:20}),e.push({x:230,y:20}),e.push({x:160,y:90}),e.push({x:170,y:90}),e.push({x:180,y:90}),e.push({x:190,y:90}),e.push({x:200,y:90}),e.push({x:210,y:90}),e.push({x:220,y:90}),e.push({x:230,y:90}),e.push({x:160,y:160}),e.push({x:170,y:160}),e.push({x:180,y:160}),e.push({x:190,y:160}),e.push({x:200,y:160}),e.push({x:210,y:160}),e.push({x:220,y:160}),e.push({x:230,y:160}),e.push({x:280,y:20}),e.push({x:280,y:30}),e.push({x:280,y:40}),e.push({x:280,y:50}),e.push({x:280,y:60}),e.push({x:280,y:70}),e.push({x:280,y:80}),e.push({x:280,y:90}),e.push({x:280,y:100}),e.push({x:280,y:110}),e.push({x:280,y:120}),e.push({x:280,y:130}),e.push({x:280,y:140}),e.push({x:280,y:150}),e.push({x:280,y:160}),e.push({x:290,y:20}),e.push({x:300,y:20}),e.push({x:310,y:20}),e.push({x:320,y:20}),e.push({x:330,y:20}),e.push({x:340,y:20}),e.push({x:350,y:20}),e.push({x:360,y:20}),e.push({x:290,y:90}),e.push({x:300,y:90}),e.push({x:310,y:90}),e.push({x:320,y:90}),e.push({x:330,y:90}),e.push({x:340,y:90}),e.push({x:350,y:90}),e.push({x:360,y:90}),e.push({x:290,y:160}),e.push({x:300,y:160}),e.push({x:310,y:160}),e.push({x:320,y:160}),e.push({x:330,y:160}),e.push({x:340,y:160}),e.push({x:350,y:160}),e.push({x:360,y:160}),e}
